{{#each dataObjectMappings}}
--
-- Persistent Staging Area Insert Into statement for {{targetDataObject.name}}
--
-- Generated from template '150 Persistent Staging Area Insert Into'.
--

INSERT INTO [{{lookupExtension targetDataObject.extensions "datastore"}}].[{{lookupExtension targetDataObject.extensions "location"}}].[{{targetDataObject.name}}]
(
   [{{../conventions.etlProcessAttribute}}], 
   [{{../conventions.loadDateTimeAttribute}}],
   [{{../conventions.eventDateTimeAttribute}}],
   [{{../conventions.sourceRowIdAttribute}}],
   [{{../conventions.changeDataCaptureAttribute}}],
   [{{../conventions.recordChecksumAttribute}}],
   {{#each dataItemMappings}}
   [{{sourceDataItems.0.name}}]{{#unless @last}},{{/unless}}
   {{/each}}
)
SELECT
   -1 AS [{{../conventions.etlProcessAttribute}}], 
   [{{../conventions.loadDateTimeAttribute}}],
   [{{../conventions.eventDateTimeAttribute}}],
   [{{../conventions.sourceRowIdAttribute}}],
   [{{../conventions.changeDataCaptureAttribute}}],
   [{{../conventions.recordChecksumAttribute}}],
   {{#each dataItemMappings}}
   [{{sourceDataItems.0.name}}]{{#unless @last}},{{/unless}}
   {{/each}}
FROM [{{../conventions.vdwSchemaName}}].[{{targetDataObject.name}}]

{{/each}}
