DECLARE @SOURCE_TYPE_{{generationSpecificMetadata.selectedDataObject.name}} VARCHAR(100);
DECLARE @TABLE_NAME_{{generationSpecificMetadata.selectedDataObject.name}} VARCHAR(1000);
DECLARE @LAYER_{{generationSpecificMetadata.selectedDataObject.name}} VARCHAR(10);
{{#each dataObjectMappings}}

select @TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}} = SUBSTRING('{{sourceDataObjects.0.name}}',charindex('_', '{{sourceDataObjects.0.name}}', (charindex('_', '{{sourceDataObjects.0.name}}', 1))+1)+1, 1000),
          @SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} = SUBSTRING('{{sourceDataObjects.0.name}}',charindex('_', '{{sourceDataObjects.0.name}}', 1)+1, charindex('_', '{{sourceDataObjects.0.name}}', (charindex('_', '{{sourceDataObjects.0.name}}', 1))+1) -charindex('_', '{{sourceDataObjects.0.name}}', 1)-1 ),
           @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}} = SUBSTRING('{{sourceDataObjects.0.name}}',0,charindex('_', '{{sourceDataObjects.0.name}}', 1));


IF @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}='DL'
BEGIN
--DataLake

	INSERT INTO [omd].[MODULE]
           ([MODULE_CODE]
           ,[MODULE_DESCRIPTION]
           ,[MODULE_TYPE]
           ,[DATA_OBJECT_SOURCE]
           ,[DATA_OBJECT_TARGET]
           ,[AREA_CODE]
           ,[FREQUENCY_CODE]
           ,[INACTIVE_INDICATOR])
		      
	 SELECT 'm_025_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}),upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+' extract file processing for '+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}),'EXT',upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}),
	 'EXT','EXT','Continuous','N'
	 from OMD.DM_MODEL dm
	 left outer join omd.module m on m.MODULE_CODE='m_025_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and layer=@LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
                 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and m.MODULE_ID is null



    INSERT INTO [omd].[MODULE]
           ([MODULE_CODE]
           ,[MODULE_DESCRIPTION]
           ,[MODULE_TYPE]
           ,[DATA_OBJECT_SOURCE]
           ,[DATA_OBJECT_TARGET]
           ,[AREA_CODE]
           ,[FREQUENCY_CODE]
           ,[INACTIVE_INDICATOR])
		   
     
	 SELECT 'm_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}),upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+' extract file processing for '+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}),'DL',upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}),
	 'EXT','DL','Continuous','N'
	 from OMD.DM_MODEL dm
	 left outer join omd.module m on m.MODULE_CODE='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and m.MODULE_ID is null

	INSERT INTO [omd].[MODULE]
           ([MODULE_CODE]
           ,[MODULE_DESCRIPTION]
           ,[MODULE_TYPE]
           ,[DATA_OBJECT_SOURCE]
           ,[DATA_OBJECT_TARGET]
           ,[AREA_CODE]
           ,[FREQUENCY_CODE]
           ,[INACTIVE_INDICATOR])
		   
     
	 SELECT 'm_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}),upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+' extract file processing for '+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}),'DL',upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}),
	 'EXT','DL','Continuous','N'
	 from OMD.DM_MODEL dm
	 left outer join omd.module m on m.MODULE_CODE='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and m.MODULE_ID is null

	INSERT INTO [omd].[MODULE]
           ([MODULE_CODE]
           ,[MODULE_DESCRIPTION]
           ,[MODULE_TYPE]
           ,[DATA_OBJECT_SOURCE]
           ,[DATA_OBJECT_TARGET]
           ,[AREA_CODE]
           ,[FREQUENCY_CODE]
           ,[INACTIVE_INDICATOR])
		   
     
	 SELECT 'm_100_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}),upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+' extract file processing for '+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}),'STG','EXT',
	 'STG','STG','Continuous','N'
	 from OMD.DM_MODEL dm
	 left outer join omd.module m on m.MODULE_CODE='m_100_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and m.MODULE_ID is null


	INSERT INTO [omd].[MODULE]
           ([MODULE_CODE]
           ,[MODULE_DESCRIPTION]
           ,[MODULE_TYPE]
           ,[DATA_OBJECT_SOURCE]
           ,[DATA_OBJECT_TARGET]
           ,[AREA_CODE]
           ,[FREQUENCY_CODE]
           ,[INACTIVE_INDICATOR])
		   
     
	 SELECT 'm_150_PSA_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}),upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+' data processing from STG ','PSA','STG',
	 'PSA','PSA','Continuous','N'
	 from OMD.DM_MODEL dm
	 left outer join omd.module m on m.MODULE_CODE='m_150_PSA_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and m.MODULE_ID is null

	INSERT INTO [omd].[BATCH]
           ([BATCH_CODE]
           ,[BATCH_DESCRIPTION]
           ,[FREQUENCY_CODE]
           ,[INACTIVE_INDICATOR]
           ,[NEXT_RUN_INDICATOR])

	 SELECT 'b_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}),upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+' data processing from '+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}),'Continuous','N',NULL
	 from OMD.DM_MODEL dm
	 left outer join omd.batch m on m.batch_code='b_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and m.batch_id is null

	INSERT INTO [omd].[BATCH]
           ([BATCH_CODE]
           ,[BATCH_DESCRIPTION]
           ,[FREQUENCY_CODE]
           ,[INACTIVE_INDICATOR]
           ,[NEXT_RUN_INDICATOR])

	 SELECT 'b_STG_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}),upper(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+' data processing from '+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}),'Continuous','N',NULL
	 from OMD.DM_MODEL dm
	 left outer join omd.batch m on m.batch_code='b_STG_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and m.batch_id is null

	INSERT INTO [omd].[BATCH_MODULE]
           ([BATCH_ID]
           ,[MODULE_ID]
           ,[INACTIVE_INDICATOR])

	SELECT b.batch_id,m.module_id,'N'
	from OMD.DM_MODEL dm
		left outer join omd.batch b on b.batch_code='b_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
		left outer join omd.module m on m.MODULE_CODE='m_025_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
		left outer join omd.batch_module bm on b.BATCH_ID=bm.BATCH_ID and bm.MODULE_ID=m.MODULE_ID
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and bm.batch_id is null

	INSERT INTO [omd].[BATCH_MODULE]
			([BATCH_ID]
			,[MODULE_ID]
			,[INACTIVE_INDICATOR])
	SELECT b.batch_id,m.module_id,'N'
	from OMD.DM_MODEL dm
		left outer join omd.batch b on b.batch_code='b_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
		left outer join omd.module m on m.MODULE_CODE='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
		left outer join omd.batch_module bm on b.BATCH_ID=bm.BATCH_ID and bm.MODULE_ID=m.MODULE_ID
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and bm.batch_id is null

	INSERT INTO [omd].[BATCH_MODULE]
			([BATCH_ID]
			,[MODULE_ID]
			,[INACTIVE_INDICATOR])
	SELECT b.batch_id,m.module_id,'N'
	from OMD.DM_MODEL dm
		left outer join omd.batch b on b.batch_code='b_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
		left outer join omd.module m on m.MODULE_CODE='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
		left outer join omd.batch_module bm on b.BATCH_ID=bm.BATCH_ID and bm.MODULE_ID=m.MODULE_ID
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and bm.batch_id is null

	INSERT INTO [omd].[BATCH_MODULE]
			([BATCH_ID]
			,[MODULE_ID]
			,[INACTIVE_INDICATOR])
	SELECT b.batch_id,m.module_id,'N'
	from OMD.DM_MODEL dm
		left outer join omd.batch b on b.batch_code='b_STG_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
		left outer join omd.module m on m.MODULE_CODE='m_100_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
		left outer join omd.batch_module bm on b.BATCH_ID=bm.BATCH_ID and bm.MODULE_ID=m.MODULE_ID
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and bm.batch_id is null

	INSERT INTO [omd].[BATCH_MODULE]
			([BATCH_ID]
			,[MODULE_ID]
			,[INACTIVE_INDICATOR])
	SELECT b.batch_id,m.module_id,'N'
	from OMD.DM_MODEL dm
		left outer join omd.batch b on b.batch_code='b_STG_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
		left outer join omd.module m on m.MODULE_CODE='m_150_PSA_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
		left outer join omd.batch_module bm on b.BATCH_ID=bm.BATCH_ID and bm.MODULE_ID=m.MODULE_ID
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and bm.batch_id is null

/*
	Add Batch wrapper b_STG_<SourceSystem>, b_EXT_<SourceSystem>
*/

	INSERT INTO [omd].[BATCH]
           ([BATCH_CODE]
           ,[BATCH_DESCRIPTION]
           ,[FREQUENCY_CODE]
           ,[INACTIVE_INDICATOR]
           ,[NEXT_RUN_INDICATOR])

	 SELECT DISTINCT 'b_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}),upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+' EXT Wrapper','Continuous','N',NULL
	 from OMD.DM_MODEL dm
	 left outer join omd.batch b on b.batch_code='b_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})
	 where dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and b.BATCH_ID is null

	INSERT INTO [omd].[BATCH]
           ([BATCH_CODE]
           ,[BATCH_DESCRIPTION]
           ,[FREQUENCY_CODE]
           ,[INACTIVE_INDICATOR]
           ,[NEXT_RUN_INDICATOR])

	 SELECT DISTINCT 'b_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}),upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+' STG Wrapper','Continuous','N',NULL
	 from OMD.DM_MODEL dm
	 left outer join omd.batch b on b.batch_code='b_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})
	 where dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and b.BATCH_ID is null


/*
	Add Batch-Batch link for wrappers
*/

	
	INSERT INTO [omd].[BATCH_BATCH]
		([PARENT_BATCH_ID]
		,[BATCH_ID]
		,[SYSTEM_GROUP]
		,[SEQUENCE]
		,[BATCH_SEQUENCE]
		,[NEXT_RUN_INDICATOR])

	SELECT DISTINCT pb.BATCH_ID as PARENT_BATCH_ID,
		cb.BATCH_ID as BATCH_ID,
		upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}) as SYSTEM_GROUP,
		1 as [SEQUENCE],
		'Concurrent' as BATCH_SEQUENCE,
		NULL as NEXT_RUN_INDICATOR

	from OMD.DM_MODEL dm
	left outer join OMD.BATCH pb ON pb.BATCH_CODE = 'b_EXT'
	left outer join OMD.BATCH cb ON cb.BATCH_CODE = 'b_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})
	left outer join OMD.BATCH_BATCH bb ON cb.BATCH_ID = bb.BATCH_ID

	WHERE dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and bb.BATCH_ID is null


	INSERT INTO [omd].[BATCH_BATCH]
		([PARENT_BATCH_ID]
		,[BATCH_ID]
		,[SYSTEM_GROUP]
		,[SEQUENCE]
		,[BATCH_SEQUENCE]
		,[NEXT_RUN_INDICATOR])

	SELECT DISTINCT pb.BATCH_ID as PARENT_BATCH_ID,
		cb.BATCH_ID as BATCH_ID,
		upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}) as SYSTEM_GROUP,
		1 as [SEQUENCE],
		'Concurrent' as BATCH_SEQUENCE,
		NULL as NEXT_RUN_INDICATOR

	from OMD.DM_MODEL dm
	left outer join OMD.BATCH pb ON pb.BATCH_CODE = 'b_STG'
	left outer join OMD.BATCH cb ON cb.BATCH_CODE = 'b_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})
	left outer join OMD.BATCH_BATCH bb ON cb.BATCH_ID = bb.BATCH_ID

	WHERE dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and bb.BATCH_ID is null


	INSERT INTO [omd].[BATCH_BATCH]
		([PARENT_BATCH_ID]
		,[BATCH_ID]
		,[SYSTEM_GROUP]
		,[SEQUENCE]
		,[BATCH_SEQUENCE]
		,[NEXT_RUN_INDICATOR])

	SELECT DISTINCT pb.BATCH_ID as PARENT_BATCH_ID,
		cb.BATCH_ID as BATCH_ID,
		upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}) as SYSTEM_GROUP,
		1 as [SEQUENCE],
		'Concurrent' as BATCH_SEQUENCE,
		NULL as NEXT_RUN_INDICATOR

	from OMD.DM_MODEL dm
	left outer join OMD.BATCH pb ON pb.BATCH_CODE = 'b_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})
	left outer join OMD.BATCH cb ON cb.BATCH_CODE = 'b_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
	left outer join OMD.BATCH_BATCH bb ON cb.BATCH_ID = bb.BATCH_ID

	WHERE dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and bb.BATCH_ID is null



	INSERT INTO [omd].[BATCH_BATCH]
		([PARENT_BATCH_ID]
		,[BATCH_ID]
		,[SYSTEM_GROUP]
		,[SEQUENCE]
		,[BATCH_SEQUENCE]
		,[NEXT_RUN_INDICATOR])

	SELECT DISTINCT pb.BATCH_ID as PARENT_BATCH_ID,
		cb.BATCH_ID as BATCH_ID,
		upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}) as SYSTEM_GROUP,
		1 as [SEQUENCE],
		'Concurrent' as BATCH_SEQUENCE,
		NULL as NEXT_RUN_INDICATOR

	from OMD.DM_MODEL dm
	left outer join OMD.BATCH pb ON pb.BATCH_CODE = 'b_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})
	left outer join OMD.BATCH cb ON cb.BATCH_CODE = 'b_STG_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
	left outer join OMD.BATCH_BATCH bb ON cb.BATCH_ID = bb.BATCH_ID

	WHERE dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and bb.BATCH_ID is null


/*
	Assigning default patterns as per below:
	m_025_EXT 	-> m_025_EXT_ADF_FTP_to_Landing 	(ID: 1)
	m_050_DL 	-> m_050_DL_ADF_Landing_to_Silver 	(ID: 2)
	m_075_DL 	-> m_075_EXT_ADF_Landing_to_Bronze	(ID: 8)
	m_100_STG 	-> m_100_STG_ADF_Silver_to_SQL		(ID: 3)
	m_150_PSA 	-> m_150_PSA_Delta_Detect_SP		(ID: 4)
	
*/

--m025

	INSERT INTO [omd].[MODULE_PATTERN]
           ([MODULE_ID]
           ,[PATTERN_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PATTERN_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_025_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PATTERN p on p.PATTERN_NAME='m_025_EXT_ADF_FTP_to_Landing'
		   	 left outer join omd.MODULE_PATTERN mp on mp.MODULE_ID=m.MODULE_ID and mp.PATTERN_ID=p.PATTERN_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PATTERN_ID is null

--m050

	INSERT INTO [omd].[MODULE_PATTERN]
           ([MODULE_ID]
           ,[PATTERN_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PATTERN_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PATTERN p on p.PATTERN_NAME='m_050_DL_ADF_Landing_to_Silver'
		   	 left outer join omd.MODULE_PATTERN mp on mp.MODULE_ID=m.MODULE_ID and mp.PATTERN_ID=p.PATTERN_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PATTERN_ID is null

--m075

	INSERT INTO [omd].[MODULE_PATTERN]
           ([MODULE_ID]
           ,[PATTERN_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PATTERN_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PATTERN p on p.PATTERN_NAME='m_075_EXT_ADF_Landing_to_Bronze'
		   	 left outer join omd.MODULE_PATTERN mp on mp.MODULE_ID=m.MODULE_ID and mp.PATTERN_ID=p.PATTERN_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PATTERN_ID is null

--m100

	INSERT INTO [omd].[MODULE_PATTERN]
           ([MODULE_ID]
           ,[PATTERN_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PATTERN_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_100_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PATTERN p on p.PATTERN_NAME='m_100_STG_ADF_Silver_to_SQL'
		   	 left outer join omd.MODULE_PATTERN mp on mp.MODULE_ID=m.MODULE_ID and mp.PATTERN_ID=p.PATTERN_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PATTERN_ID is null

--m150

	INSERT INTO [omd].[MODULE_PATTERN]
           ([MODULE_ID]
           ,[PATTERN_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PATTERN_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_150_PSA_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PATTERN p on p.PATTERN_NAME='m_150_PSA_Delta_Detect_SP'
		   	 left outer join omd.MODULE_PATTERN mp on mp.MODULE_ID=m.MODULE_ID and mp.PATTERN_ID=p.PATTERN_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PATTERN_ID is null


--All other empty modules assigned 15 Dummy pattern (this should never insert a record in normal circumstances)

	INSERT INTO [omd].[MODULE_PATTERN]
           ([MODULE_ID]
           ,[PATTERN_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id,15,'N' from omd.module m
		   left outer join omd.module_pattern mp on m.module_id=mp.module_id
		   where  mp.MODULE_ID is null

/*
	Creating Parameters and relationships to modules
*/

--m025
	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'List of Folders to process for '+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+' FTP', N''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_LIST', N'', N'EXT_FTP_FOLDER_LIST', N'N'
			from OMD.DM_MODEL dm
				left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_LIST'
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and p.PARAMETER_ID is null
	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'File Extensions CSV', N'CSV_FILE_EXTENSION', N'.csv', N'EXT_FILE_EXTENSION', N'N'
			from OMD.DM_MODEL dm
				left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='CSV_FILE_EXTENSION'
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and p.PARAMETER_ID is null
	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT N'File name', N'FILE_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N''+dm.TABLE_NAME+'', N'EXT_FILE_NAME', N'N'
			from OMD.DM_MODEL dm
				left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and p.PARAMETER_ID is null
	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'File prefix', N'FILE_PREFIX_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'', N'EXT_FILE_PREFIX', N'N'
			from OMD.DM_MODEL dm
				left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_PREFIX_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and p.PARAMETER_ID is null
	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'File suffix', N'FILE_SUFFIX_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'*', N'EXT_FILE_SUFFIX', N'N'
			from OMD.DM_MODEL dm
				left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_SUFFIX_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and p.PARAMETER_ID is null
	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+' Folder Path', N''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_PATH', N'', N'EXT_FTP_FOLDER_PATH', N'N'
			from OMD.DM_MODEL dm
				left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_PATH'
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and p.PARAMETER_ID is null
	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT N''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+' Folder Name', N''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_NAME', N'', N'EXT_FTP_FOLDER_NAME', N'N'
			from OMD.DM_MODEL dm
				left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_NAME'
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and p.PARAMETER_ID is null
	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'Landing Folder name', N'LANDING_FOLDER_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N''+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'\', N'EXT_LANDING_FOLDER_NAME', N'N'
			from OMD.DM_MODEL dm
				left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='LANDING_FOLDER_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and p.PARAMETER_ID is null
	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'Landing Folder path', N''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_LANDING_FOLDER_PATH', N'jarvis\'+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'\', N'EXT_LANDING_FOLDER_PATH', N'N'
			from OMD.DM_MODEL dm
				left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_LANDING_FOLDER_PATH'
		where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
		and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
		and p.PARAMETER_ID is null
		
 	 INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_025_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_LIST'
				left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null



 	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_025_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='CSV_FILE_EXTENSION'
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_025_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_025_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_PREFIX_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_025_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_SUFFIX_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_025_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_PATH'
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_025_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_NAME'
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null

		INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_025_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='LANDING_FOLDER_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_025_EXT_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_LANDING_FOLDER_PATH'
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null


	 --m_050
		   
	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT  DISTINCT  N'List of Folders to process for '+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+' FTP', N''+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_FTP_FOLDER_LIST', N'["2022-08-03"]', N'EXT_FTP_FOLDER_LIST', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_FTP_FOLDER_LIST'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT  DISTINCT  N'Landing Folder path', N''+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_LANDING_FOLDER_PATH', N'jarvis\'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'\', N'EXT_LANDING_FOLDER_PATH', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_LANDING_FOLDER_PATH'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT  DISTINCT  N'Data Lake Database', N'DATA_LAKE_DATABASE', N'default', N'DL_SLVR_DATABASE', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DATA_LAKE_DATABASE'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT  DISTINCT  N'Data Lake Tablename', N'DATA_LAKE_TABLE_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'DL_SLVR_TABLENAME', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DATA_LAKE_TABLE_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT  DISTINCT  N'Data Lake Silver Layer INSERT Command', N'DL_SILVER_INSERT_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'', N'DL_SLVR_INSERT', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DL_SILVER_INSERT_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT DISTINCT   N'Data Lake Silver Layer INSERT Deleted Record Command', N'DL_SILVER_DELETE_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'', N'DL_SLVR_DELETE', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DL_SILVER_DELETE_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT DISTINCT   N'Data Lake Silver Layer Update Deleted Record Command', N'DL_SILVER_UPDATE_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'', N'DL_SLVR_UPDATE', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DL_SILVER_UPDATE_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT  DISTINCT  N'Source System', N'SOURCE_SYSTEM_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N''+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'SOURCE_SYSTEM', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SOURCE_SYSTEM_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT  DISTINCT  N'LANDING TO STG SELECT Command', N'LANDING_TO_STAGING_SELECT_STG_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'', N'LANDING_VW_SELECT', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='LANDING_TO_STAGING_SELECT_STG_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT  DISTINCT  N''+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+' File Format Options', N'FILE_FORMAT_OPTIONS_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'{"inferSchema":False,"header":True,"sep":",","encoding":"UTF-8","multiLine":True}', N'DL_SLVR_FILE_FORMAT_OPTIONS', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_FORMAT_OPTIONS_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT  DISTINCT  N'Silver File Suffix', N'DL_SLVR_FILE_SUFFIX_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}+'', N'', N'DL_SLVR_FILE_SUFFIX', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DL_SLVR_FILE_SUFFIX_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT  DISTINCT  N'Silver File Exclude Columns from Hash', N'DL_SLVR_FILE_EXCLUDE_COLUMN_HASH_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}+'', N'', N'DL_SLVR_FILE_EXCLUDE_COLUMN_HASH', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DL_SLVR_FILE_EXCLUDE_COLUMN_HASH_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT  DISTINCT  N'OMD Record Source ID', N'OMD_RECORD_SOURCE_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'1', N'OMD_RECORD_SOURCE_ID', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='OMD_RECORD_SOURCE_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT  DISTINCT  N'Azure SQL DL Pre Command', N'PRE_SQL_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'', N'PRE_SQL', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='PRE_SQL_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR])
	SELECT  DISTINCT  N'Azure SQL DL Post Command', N'POST_SQL_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'', N'POST_SQL', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='POST_SQL_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null
	 

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_FTP_FOLDER_LIST'
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_LANDING_FOLDER_PATH'
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DATA_LAKE_DATABASE'
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='CSV_FILE_EXTENSION'
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DATA_LAKE_TABLE_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DL_SILVER_INSERT_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DL_SILVER_DELETE_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DL_SILVER_UPDATE_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SOURCE_SYSTEM_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='LANDING_TO_STAGING_SELECT_STG_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_FORMAT_OPTIONS_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DL_SLVR_FILE_SUFFIX_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='DL_SLVR_FILE_EXCLUDE_COLUMN_HASH_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='OMD_RECORD_SOURCE_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

	 INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='PRE_SQL_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	 INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='POST_SQL_DL_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_PREFIX_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_050_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='LANDING_FOLDER_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

		  --m_075
			  
	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT  DISTINCT N'List of Folders to process for '+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+' FTP', N''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_LIST', N'', N'EXT_FTP_FOLDER_LIST', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_LIST'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT  DISTINCT N'File Extensions CSV', N'CSV_FILE_EXTENSION', N'.csv', N'EXT_FILE_EXTENSION', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='CSV_FILE_EXTENSION'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT N'File name', N'FILE_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N''+dm.TABLE_NAME+'', N'EXT_FILE_NAME', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'File prefix', N'FILE_PREFIX_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'', N'EXT_FILE_PREFIX', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_PREFIX_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT  DISTINCT N'File suffix', N'FILE_SUFFIX_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'*', N'EXT_FILE_SUFFIX', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_SUFFIX_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT  DISTINCT N''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+' Folder Path', N''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_PATH', N'', N'EXT_FTP_FOLDER_PATH', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_PATH'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT N''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+' Folder Name', N''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_NAME', N'', N'EXT_FTP_FOLDER_NAME', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_NAME'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'Landing Folder name', N'LANDING_FOLDER_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N''+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'\', N'EXT_LANDING_FOLDER_NAME', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='LANDING_FOLDER_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'Landing Folder path', N''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_LANDING_FOLDER_PATH', N'jarvis\'+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'\', N'EXT_LANDING_FOLDER_PATH', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_LANDING_FOLDER_PATH'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 	 
	SELECT DISTINCT  N'Bronze Folder name', N'BRONZE_FOLDER_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N''+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'\', N'EXT_BRONZE_FOLDER_NAME', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='BRONZE_FOLDER_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'Bronze Folder path', N''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_BRONZE_FOLDER_PATH', N'jarvis\'+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'\', N'EXT_BRONZE_FOLDER_PATH', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_BRONZE_FOLDER_PATH'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null
	 
	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_LIST'
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null



	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='CSV_FILE_EXTENSION'
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_PREFIX_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='FILE_SUFFIX_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_PATH'
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_FTP_FOLDER_NAME'
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='LANDING_FOLDER_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_LANDING_FOLDER_PATH'
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='BRONZE_FOLDER_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
		([MODULE_ID]
		,[PARAMETER_ID]
		,[INACTIVE_INDICATOR])
		SELECT m.module_id, p.PARAMETER_ID,'N'
				from  OMD.DM_MODEL dm
				inner join OMD.MODULE m on module_code='m_075_DL_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE=''+@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}}+'_BRONZE_FOLDER_PATH'
			left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	and mp.PARAMETER_ID is null

--m_100
	INSERT INTO [omd].PARAMETER([PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'Azure SQL STG Database Schema', N'SQL_STAGING_DATABASE_SCHEMA', N'STG', N'SQL_STG_DATABASE_SCHEMA', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_STAGING_DATABASE_SCHEMA'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'Azure SQL STG Database Tablename', N'SQL_STAGING_TABLE_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'STG_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'SQL_STG_DATABASE_TABLENAME', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_STAGING_TABLE_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'ADB TO DW STG SQL SELECT Command', N'SILVER_TO_STAGING_SELECT_STG_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'', N'SQL_STG_SELECT', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SILVER_TO_STAGING_SELECT_STG_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'OMD Module Instance ID for latest Run', N'OMD_MODULE_INSTANCE_ID_LATEST_RUN', N'', N'OMD_MODULE_INSTANCE_ID_LATEST_RUN', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='OMD_MODULE_INSTANCE_ID_LATEST_RUN'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT N'Azure SQL STG Pre Command', N'PRE_SQL_STG_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'', N'PRE_SQL', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='PRE_SQL_STG_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'Azure SQL STG Post Command', N'POST_SQL_STG_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'', N'POST_SQL', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='POST_SQL_STG_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null
	 
	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_100_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_STAGING_DATABASE_SCHEMA'
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null



	INSERT INTO [omd].[MODULE_PARAMETER]
      ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_100_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_STAGING_TABLE_NAME_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_100_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SILVER_TO_STAGING_SELECT_STG_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_100_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='OMD_MODULE_INSTANCE_ID_LATEST_RUN'
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_100_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='PRE_SQL_STG_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null
	 
	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_100_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='POST_SQL_STG_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null 

--Added by TP
	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_100_STG_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}}
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SOURCE_SYSTEM_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null	 

	 --m_150
	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT N'Azure SQL PSA Database Schema', N'SQL_PSA_DATABASE_SCHEMA', N'PSA', N'SQL_PSA_DATABASE_SCHEMA', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_PSA_DATABASE_SCHEMA'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT  DISTINCT N'Azure SQL PSA Database Tablename', N'SQL_PSA_TABLE_NAME_PSA_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'PSA_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'SQL_PSA_DATABASE_TABLENAME', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_PSA_TABLE_NAME_PSA_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'Azure SQL PSA Stored Proc Name', N'SQL_PSA_SP_NAME_SP_PSA_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'SP_PSA_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'SQL_PSA_SP_NAME', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_PSA_SP_NAME_SP_PSA_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER(  [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'Azure SQL Multi Active Key', N'SQL_MULTIACTIVE_KEY', N'', N'SQL_MULTIACTIVE_KEY', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_MULTIACTIVE_KEY'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT N'Azure SQL Driving Key', N'SQL_DRIVING_KEY', N'', N'SQL_DRIVING_KEY', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_DRIVING_KEY'
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT N'Azure SQL PSA Pre Command', N'PRE_SQL_PSA_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'', N'PRE_SQL', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='PRE_SQL_PSA_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null

	INSERT INTO [omd].PARAMETER ( [PARAMETER_DESCRIPTION], [PARAMETER_KEY_CODE], [PARAMETER_VALUE_CODE], [PARAMETER_AREA_CODE], [INACTIVE_INDICATOR]) 
	SELECT DISTINCT  N'Azure SQL STG Post Command', N'POST_SQL_PSA_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+'', N'', N'POST_SQL', N'N'
		   from OMD.DM_MODEL dm
		   	 left outer join omd.PARAMETER p on p.PARAMETER_KEY_CODE='POST_SQL_PSA_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and p.PARAMETER_ID is null
	 

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_150_PSA_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_PSA_DATABASE_SCHEMA'
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		  		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_150_PSA_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_PSA_TABLE_NAME_PSA_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_150_PSA_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_PSA_SP_NAME_SP_PSA_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_150_PSA_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_MULTIACTIVE_KEY'
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_150_PSA_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='SQL_DRIVING_KEY'
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null

	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_150_PSA_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='PRE_SQL_PSA_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null
	 
	INSERT INTO [omd].[MODULE_PARAMETER]
           ([MODULE_ID]
           ,[PARAMETER_ID]
           ,[INACTIVE_INDICATOR])
		   SELECT m.module_id, p.PARAMETER_ID,'N'
		   		   from  OMD.DM_MODEL dm
				   inner join OMD.MODULE m on module_code='m_150_PSA_'+upper(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})
				   inner join omd.PARAMETER p on p.PARAMETER_KEY_CODE='POST_SQL_PSA_'+UPPER(@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}})+'_'+UPPER(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}})+''
		   	 left outer join omd.MODULE_PARAMETER mp on mp.MODULE_ID=m.MODULE_ID and mp.PARAMETER_ID=p.PARAMETER_ID
	 where source_type=@SOURCE_TYPE_{{../generationSpecificMetadata.selectedDataObject.name}} and LAYER = @LAYER_{{../generationSpecificMetadata.selectedDataObject.name}}   
	 and dm.TABLE_NAME like replace(@TABLE_NAME_{{../generationSpecificMetadata.selectedDataObject.name}},'-','_') --Using "LIKE" to ignore case-sensitivity (occurs in DBeaver)
	 and mp.PARAMETER_ID is null


END

{{/each}}
